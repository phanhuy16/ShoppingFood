@model ProductRatingViewModel

@{
	ViewData["Title"] = "Detail Page";
}

<style>
	.rating {
		display: flex;
		flex-direction: row-reverse;
		font-size: 16px;
		justify-content: center;
		gap: 5px;
	}

		.rating input {
			display: none;
		}

		.rating label {
			color: lightgray;
			cursor: pointer;
			transition: color 0.3s;
		}

			.rating input:checked ~ label,
			.rating label:hover,
			.rating label:hover ~ label {
				color: gold;
			}

</style>

<!-- Single Page Header start -->
<div class="container-fluid page-header py-5">
	<h1 class="text-center text-white display-6">Shop Detail</h1>
	<ol class="breadcrumb justify-content-center mb-0">
		<li class="breadcrumb-item"><a href="#">Home</a></li>
		<li class="breadcrumb-item"><a href="#">Pages</a></li>
		<li class="breadcrumb-item active text-white">Shop Detail</li>
	</ol>
</div>
<!-- Single Page Header End -->
<!-- Single Product Start -->
<div class="container-fluid py-5 mt-5">
	<div class="container py-5">
		<div class="row g-4 mb-5">
			<div class="col-lg-8 col-xl-9">
				<div class="row g-4">
					<div class="col-lg-6">
						<div class="border rounded">
							<a href="#">
								<img src="~/media/products/@Model.Product.Image" class="img-fluid rounded" alt="Image">
							</a>
						</div>
					</div>
					<div class="col-lg-6">
						<h4 class="fw-bold mb-3">@Model.Product.Name</h4>
						<p class="mb-3">Category: @Model.Product.Category.Name</p>
						<h5 class="fw-bold mb-3">@Model.Product.Price.ToString("#,##0 VND")</h5>
						<div class="d-flex mb-4">
							@if (Model.Reviews != null && Model.Reviews.Any())
							{
								@for (int i = 1; i <= 5; i++)
								{
									if (i <= Model.Reviews.First().Star)
									{
										<i class="fa fa-star text-secondary"></i>
									}
									else
									{
										<i class="fa fa-star"></i>
									}
								}
							}
							else
							{
								<p>Chưa có đánh giá</p>
							}
						</div>
						<p class="mb-4">@Model.Product.Description.</p>
						<div class="input-group quantity mb-5" style="width: 100px;">
							<div class="input-group-btn">
								<button class="btn btn-sm btn-minus rounded-circle bg-light border">
									<i class="fa fa-minus"></i>
								</button>
							</div>
							<input type="text" class="form-control form-control-sm text-center border-0" value="1">
							<div class="input-group-btn">
								<button class="btn btn-sm btn-plus rounded-circle bg-light border">
									<i class="fa fa-plus"></i>
								</button>
							</div>
						</div>
						@if (Model.Product.Quantity > 0)
						{
							<button class="btn border border-secondary rounded-pill px-4 py-2 mb-4 text-primary add-to-cart" data-id="@Model.Product.Id"><i class="fa fa-shopping-bag me-2 text-primary"></i> Add to cart</button>
						}
						else
						{
							<button class="btn border border-secondary rounded-pill px-4 py-2 mb-4 text-primary"> Hết hàng </button>
						}
					</div>
					<div class="col-lg-12">
						<nav>
							<div class="nav nav-tabs mb-3">
								<button class="nav-link active border-white border-bottom-0" type="button" role="tab"
										id="nav-about-tab" data-bs-toggle="tab" data-bs-target="#nav-about"
										aria-controls="nav-about" aria-selected="true">
									Description
								</button>
								<button class="nav-link border-white border-bottom-0" type="button" role="tab"
										id="nav-mission-tab" data-bs-toggle="tab" data-bs-target="#nav-mission"
										aria-controls="nav-mission" aria-selected="false">
									Reviews
								</button>
							</div>
						</nav>
						<div class="tab-content mb-5">
							<div class="tab-pane active" id="nav-about" role="tabpanel" aria-labelledby="nav-about-tab">
								<p>
									@Model.Product.Description
								</p>
								<div class="px-2">
									<div class="row g-4">
										<div class="col-6">
											@Html.Raw(Model.Product.Detail)
										</div>
									</div>
								</div>
							</div>
							<div class="tab-pane" id="nav-mission" role="tabpanel" aria-labelledby="nav-mission-tab">
								@if (Model.Reviews != null && Model.Reviews.Any())
								{
									@foreach (var item in Model.Reviews)
									{
										<div class="d-flex">
											<img src="~/img/avatar.jpg" class="img-fluid rounded-circle p-3" style="width: 100px; height: 100px;" alt="">
											<div class="">
												<p class="mb-2" style="font-size: 14px;">@item.CreatedDate.ToString("dd/MM/yyyy")</p>
												<div class="d-flex justify-content-between">
													<div>
														@if (item.Users != null)
														{
															<h5>@item.Users.Email</h5>
														}
														else
														{
															<span>Unknown Email</span>
														}
													</div>
													<div class="d-flex mb-3">
														@for (int i = 1; i <= 5; i++)
														{
															if (i <= item.Star)
															{
																<i class="fa fa-star text-secondary"></i>
															}
															else
															{
																<i class="fa fa-star"></i>
															}
														}
													</div>
												</div>
												<p>
													@item.Comment
												</p>
											</div>
										</div>
									}
								}
								else
								{
									<p>Sản phẩm này chưa có bài đánh giá nào.</p>
								}
							</div>
							<div class="tab-pane" id="nav-vision" role="tabpanel">
								<p class="text-dark">
									Tempor erat elitr rebum at clita. Diam dolor diam ipsum et tempor sit. Aliqu diam
									amet diam et eos labore. 3
								</p>
								<p class="mb-0">
									Diam dolor diam ipsum et tempor sit. Aliqu diam amet diam et eos labore.
									Clita erat ipsum et lorem et sit
								</p>
							</div>
						</div>
					</div>
					@if (User.Identity.IsAuthenticated)
					{
						<form asp-action="Comment" asp-controller="Product" method="post">
							<input type="hidden" asp-for="@Model.Product.Id" name="ProductId" />
							<h4 class="mb-5 fw-bold">Leave a Reply</h4>
							<div class="row g-4">
								<div class="col-lg-12">
									<div class="border-bottom rounded my-4">
										<textarea asp-for="@Model.Comment" class="form-control border-0" cols="30" rows="8" placeholder="Your Review *" spellcheck="false"></textarea>
										<span asp-validation-for="@Model.Comment" class="text-danger"></span>
									</div>
								</div>
								<div class="col-lg-12">
									<div class="d-flex justify-content-between py-3 mb-5">
										<div class="d-flex align-items-center">
											<p class="mb-0 me-3">Please rate:</p>
											<div class="rating">
												<input type="radio" name="Star" value="5" id="star5"><label for="star5"><i class="fa fa-star"></i></label>
												<input type="radio" name="Star" value="4" id="star4"><label for="star4"><i class="fa fa-star"></i></label>
												<input type="radio" name="Star" value="3" id="star3"><label for="star3"><i class="fa fa-star"></i></label>
												<input type="radio" name="Star" value="2" id="star2"><label for="star2"><i class="fa fa-star"></i></label>
												<input type="radio" name="Star" value="1" id="star1"><label for="star1"><i class="fa fa-star"></i></label>
											</div>
										</div>
										<button type="submit" class="btn border border-secondary text-primary rounded-pill px-4 py-3"> Post Comment</button>
									</div>
								</div>
							</div>
						</form>
					}
					else
					{
						<p>Vui lòng đăng nhập để đánh giá về sản phẩm này.</p>
					}
				</div>
			</div>
			<div class="col-lg-4 col-xl-3">
				<div class="row g-4 fruite">
					<div class="col-lg-12">
						<div class="input-group w-100 mx-auto d-flex mb-4">
							<input type="search" class="form-control p-3" placeholder="keywords" aria-describedby="search-icon-1">
							<span id="search-icon-1" class="input-group-text p-3"><i class="fa fa-search"></i></span>
						</div>
						<div class="mb-4">
							<h4>Categories</h4>
							<ul class="list-unstyled fruite-categorie">
								<vc:product-categories></vc:product-categories>
							</ul>
						</div>
					</div>
					<div class="col-lg-12">
						<h4 class="mb-4">Featured products</h4>
						<div class="d-flex align-items-center justify-content-start">
							<div class="rounded" style="width: 100px; height: 100px;">
								<img src="~/img/featur-1.jpg" class="img-fluid rounded" alt="Image">
							</div>
							<div>
								<h6 class="mb-2">Big Banana</h6>
								<div class="d-flex mb-2">
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star"></i>
								</div>
								<div class="d-flex mb-2">
									<h5 class="fw-bold me-2">2.99 $</h5>
									<h5 class="text-danger text-decoration-line-through">4.11 $</h5>
								</div>
							</div>
						</div>
						<div class="d-flex align-items-center justify-content-start">
							<div class="rounded" style="width: 100px; height: 100px;">
								<img src="~/img/featur-2.jpg" class="img-fluid rounded" alt="">
							</div>
							<div>
								<h6 class="mb-2">Big Banana</h6>
								<div class="d-flex mb-2">
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star"></i>
								</div>
								<div class="d-flex mb-2">
									<h5 class="fw-bold me-2">2.99 $</h5>
									<h5 class="text-danger text-decoration-line-through">4.11 $</h5>
								</div>
							</div>
						</div>
						<div class="d-flex align-items-center justify-content-start">
							<div class="rounded" style="width: 100px; height: 100px;">
								<img src="~/img/featur-3.jpg" class="img-fluid rounded" alt="">
							</div>
							<div>
								<h6 class="mb-2">Big Banana</h6>
								<div class="d-flex mb-2">
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star"></i>
								</div>
								<div class="d-flex mb-2">
									<h5 class="fw-bold me-2">2.99 $</h5>
									<h5 class="text-danger text-decoration-line-through">4.11 $</h5>
								</div>
							</div>
						</div>
						<div class="d-flex align-items-center justify-content-start">
							<div class="rounded me-4" style="width: 100px; height: 100px;">
								<img src="~/img/vegetable-item-4.jpg" class="img-fluid rounded" alt="">
							</div>
							<div>
								<h6 class="mb-2">Big Banana</h6>
								<div class="d-flex mb-2">
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star"></i>
								</div>
								<div class="d-flex mb-2">
									<h5 class="fw-bold me-2">2.99 $</h5>
									<h5 class="text-danger text-decoration-line-through">4.11 $</h5>
								</div>
							</div>
						</div>
						<div class="d-flex align-items-center justify-content-start">
							<div class="rounded me-4" style="width: 100px; height: 100px;">
								<img src="~/img/vegetable-item-5.jpg" class="img-fluid rounded" alt="">
							</div>
							<div>
								<h6 class="mb-2">Big Banana</h6>
								<div class="d-flex mb-2">
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star"></i>
								</div>
								<div class="d-flex mb-2">
									<h5 class="fw-bold me-2">2.99 $</h5>
									<h5 class="text-danger text-decoration-line-through">4.11 $</h5>
								</div>
							</div>
						</div>
						<div class="d-flex align-items-center justify-content-start">
							<div class="rounded me-4" style="width: 100px; height: 100px;">
								<img src="~/img/vegetable-item-6.jpg" class="img-fluid rounded" alt="">
							</div>
							<div>
								<h6 class="mb-2">Big Banana</h6>
								<div class="d-flex mb-2">
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star text-secondary"></i>
									<i class="fa fa-star"></i>
								</div>
								<div class="d-flex mb-2">
									<h5 class="fw-bold me-2">2.99 $</h5>
									<h5 class="text-danger text-decoration-line-through">4.11 $</h5>
								</div>
							</div>
						</div>
						<div class="d-flex justify-content-center my-4">
							<a href="#" class="btn border border-secondary px-4 py-3 rounded-pill text-primary w-100">Vew More</a>
						</div>
					</div>
					<div class="col-lg-12">
						<div class="position-relative">
							<img src="~/img/banner-fruits.jpg" class="img-fluid w-100 rounded" alt="">
							<div class="position-absolute" style="top: 50%; right: 10px; transform: translateY(-50%);">
								<h3 class="text-secondary fw-bold">Fresh <br> Fruits <br> Banner</h3>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<h1 class="fw-bold mb-0">Related products</h1>
		<div class="vesitable">
			<div class="owl-carousel vegetable-carousel justify-content-center">
				@if (ViewBag.Related != null)
				{
					foreach (var item in ViewBag.Related as IEnumerable<ProductModel>)
					{
						<div class="border border-primary rounded position-relative vesitable-item">
							<div class="vesitable-img">
								<img src="~/media/products/@item.Image" class="img-fluid w-100 rounded-top" alt="">
							</div>
							@if (User.Identity.IsAuthenticated)
							{
								<button class="px-2 py-1 bg-transparent rounded border border-pri position-absolute add-to-wishlist" style="top: 10px; left: 10px;" data-id="@item.Id"><i class="fas fa-heart text-primary"></i></button>
							}
							<div class="text-white bg-primary px-3 py-1 rounded position-absolute" style="top: 10px; right: 10px;">@item.Category.Name</div>
							<div class="p-4 pb-0 rounded-bottom">
								<h4>@item.Name</h4>
								<p>@item.Description</p>
								<div class="text-center">
									<p class="text-dark fs-5 fw-bold">@item.Price.ToString("#,##0 VND") / kg</p>

									@if (item.Quantity > 0)
									{
										if (User.Identity.IsAuthenticated)
										{
											<div class="d-flex justify-content-between flex-lg-wrap mt-3">
												<button data-id="@item.Id" class="btn border border-secondary rounded-pill px-3 text-primary mb-4 add-to-cart">
													<i class="fa fa-shopping-bag me-2 text-primary"></i> Add to cart
												</button>

												<button data-id="@item.Id" class="btn border border-secondary rounded-pill px-3 text-primary mb-4 add-to-compare">
													<i class="fas fa-plus-square text-primary"></i>
												</button>
											</div>
										}
										else
										{
											<div class="d-flex justify-content-center flex-lg-wrap mt-3">
												<button data-id="@item.Id" class="btn border border-secondary rounded-pill px-3 text-primary mb-4 add-to-cart">
													<i class="fa fa-shopping-bag me-2 text-primary"></i> Add to cart
												</button>
											</div>
										}
									}
									else
									{
										<div class="d-flex justify-content-center flex-lg-wrap mt-3">
											<button class="btn border border-secondary rounded-pill px-3 text-primary mb-4">
												Hết hàng
											</button>
										</div>
									}
								</div>
							</div>
						</div>
					}
				}
				else
				{
					<p>No related products</p>
				}
			</div>
		</div>
	</div>
</div>
<!-- Single Product End -->
@section Scripts {
	<script>
		$(document).ready(function () {
			$('.add-to-cart').click(function () {
				var id = $(this).data('id');

				$.ajax({
					url: "@Url.Action("Add", "Cart")",
					data: { id: id },
					type: 'POST',
					success: function (response) {
						if (response.success) {
							notyf.success(response.message);
						} else {
							notyf.error(response.message);
						}
					}
				});
			});


			$('.add-to-wishlist').click(function () {
				var id = $(this).data('id');

				$.ajax({
					url: "@Url.Action("AddWishlist", "Home")",
					data: { id: id },
					type: 'POST',
					success: function (response) {
						if (response.success) {
							notyf.success(response.message);
						} else {
							notyf.error("Error add wishlist");
						}
					}
				});
			});

			$('.add-to-compare').click(function () {
				var id = $(this).data('id');

				$.ajax({
					url: "@Url.Action("AddCompare", "Home")",
					data: { id: id },
					type: 'POST',
					success: function (response) {
						if (response.success) {
							notyf.success(response.message);
						} else {
							notyf.error("Error add wishlist");
						}
					}
				});
			});

			$(".rating input").change(function () {
				let rating = $(this).val();
			});
		});
	</script>
}